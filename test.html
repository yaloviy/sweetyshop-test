<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞–≥–∞–∑–∏–Ω –≤ Telegram</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 10px; }
        .product { border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px; }
        button { background: #0088cc; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; }
        #cart { position: fixed; bottom: 10px; right: 10px; background: #28a745; color: white; padding: 10px; border-radius: 50%; }
    </style>
</head>
<body>
    <h1>üõçÔ∏è –ù–∞—à–∏ —Ç–æ–≤–∞—Ä—ã</h1>
    <div id="products"></div>
    <div id="cart">0</div>

    <script>
        let cart = [];
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã –∏–∑ –ë–î (—á–µ—Ä–µ–∑ API –±–æ—Ç–∞)
        fetch("http://localhost:5000/get-products")
            .then(res => res.json())
            .then(products => {
                const productsContainer = document.getElementById("products");
                products.forEach(product => {
                    productsContainer.innerHTML += `
                        <div class="product">
                            <h3>${product.name}</h3>
                            <p>–¶–µ–Ω–∞: ${product.price} —Ä—É–±.</p>
                            <button onclick="addToCart(${product.id}, '${product.name}', ${product.price})">
                                + –í –∫–æ—Ä–∑–∏–Ω—É
                            </button>
                        </div>
                    `;
                });
            });

        function addToCart(id, name, price) {
            cart.push({ id, name, price, quantity: 1 });
            updateCartUI();
        }

        function updateCartUI() {
            document.getElementById("cart").textContent = cart.length;
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞ –≤ –±–æ—Ç
        function checkout() {
            if (cart.length === 0) return alert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!");
            
            Telegram.WebApp.sendData(JSON.stringify({
                user_id: Telegram.WebApp.initDataUnsafe.user?.id,
                cart: cart
            }));
            
            Telegram.WebApp.close();
        }

        // –ö–Ω–æ–ø–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
        document.getElementById("cart").addEventListener("click", checkout);
    </script>
</body>
</html>